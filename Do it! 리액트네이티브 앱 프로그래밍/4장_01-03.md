# **04_1 ë¦¬ì•¡íŠ¸ í›… ë§›ë³´ê¸°**

âœ…Â useEffect Hook

âœ…Â useState Hook

âœ…Â Custom Hook

---

## React Hookì´ë€?

ğŸ‘‰ í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ê°€ ì–´ë–¤ ê°’ì„ ìœ ì§€í•  ìˆ˜ ìˆë„ë¡ ë§Œë“  ìƒˆë¡œìš´ ê°œë…ì˜ ë°ì´í„° ìºì‹œ ì‹œìŠ¤í…œ

ğŸ“ŒÂ **ì‚¬ìš© ì‹œ ì£¼ì˜í•´ì•¼í•  ì **

1) ê°™ì€ ë¦¬ì•¡íŠ¸ í›…ì„ ì—¬ëŸ¬ ë²ˆ í˜¸ì¶œ í•  ìˆ˜ ìˆë‹¤.

2) í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ ëª¸í†µì´ ì•„ë‹Œ, ëª¸í†µ ì•ˆ ë³µí•© ì‹¤í–‰ë¬¸ì˜ { } ì—ì„œëŠ” í˜¸ì¶œí•  ìˆ˜ ì—†ë‹¤.

3) ë¹„ë™ê¸° í•¨ìˆ˜(async í•¨ìˆ˜)ëŠ” ì½œë°±í•¨ìˆ˜ë¡œ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.

## useEffect hook

```jsx
import React, {useEffect} from 'react'

export default function App() {
	let time = new Date()
	useEffect(() => {
		const id = setInterval(() => {
			time = new Date()
		}, 1000)
		return () => clearInterval(id)
	},[])
	return <></>
}
```

ìœ„ ì½”ë“œëŠ” setInterval()ì„ í•œë²ˆ í˜¸ì¶œí•˜ì˜€ì„ ë¿, re-renderingì„ ì‹¤í–‰í•˜ì§€ ëª»í•œë‹¤.

re-renderingì„ ì‹¤í–‰í•˜ë ¤ë©´, `useState` í›…ì„ ì‚¬ìš©í•´ì•¼ í•œë‹¤.

## useState hook

```jsx
import React, {useEffect, useState} from 'react'
import {StyleSheet, safeAreaView, Text} from 'react-native'

export default function App() {
	const [time, setTime] = useState(new Date())
	useEffect(() => {
		const id = setInterval(() => {
			setTime(new Date())
		}, 1000)
		return () => clearInterval(id)
	}, [])
}
```

ì´ì™€ ê°™ì€ `useState` í›…ì„ ì‚¬ìš©í•˜ì—¬ re-renderingí•  ìˆ˜ ìˆë‹¤.

## Custom hook

```jsx
import { useState, useEffect } from 'react'

export const useClock = () => {
	const [time, setTime] = useState(new Date())
	useEffect(() => {
		const id = setInterval(() => {
			setTime(new Date())
		}, 1000)
		return () => clearInterval(id)
	}, [])
	return time
}

```

# **04_2 useMemoì™€ useCallback í›… ì´í•´í•˜ê¸°**

âœ…Â ScrollView

âœ…Â ì „ì—­ë³€ìˆ˜ì™€ ìºì‹œ

âœ…Â useMemo

âœ…Â useCallback

---

## ScrollView

ğŸ“ŒÂ **ìˆ˜í‰ë°©í–¥ ìŠ¤í¬ë¡¤**

```jsx
<ScrollView horizontal={true} />
```

ğŸ“ŒÂ `<ScrollView/>`  ì™€ `<FlatList/>`  ì¤‘ ì–´ë–¤ê±¸ ì‚¬ìš©í•´ì•¼í• ê¹Œ?

ScrollViewëŠ” í™”ë©´ìƒì— ë³´ì´ì§€ ì•ŠëŠ” ë¶€ë¶„ê¹Œì§€ Child Componentë“¤ì„ í•œë²ˆì— ëª¨ë‘ ë Œë”ë§ í•œë‹¤. ë”°ë¼ì„œ ì„±ëŠ¥ìƒì˜ ì €í•˜ê°€ ì¼ì–´ë‚  ìˆ˜ ìˆë‹¤.

FlatListëŠ” lazy-loadingìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§í•œë‹¤. ì•„ì§ í™”ë©´ìƒì— ë³´ì´ì§€ ì•ŠëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” ë Œë”ë§í•˜ì§€ ì•Šê³ , ë°˜ëŒ€ë¡œ í™”ë©´ì—ì„œ ë³´ì´ë‹¤ê°€ ì‚¬ë¼ì§„ ì»´í¬ë„ŒíŠ¸ëŠ” ì§€ì›€ìœ¼ë¡œì¨ ë©”ëª¨ë¦¬ë¥¼ ì ˆì•½í•œë‹¤.

---

FlatList â‡’ ë°°ì—´ì„ ë Œë”ë§í• ë•Œ

ScrollView â‡’ 

## ì „ì—­ë³€ìˆ˜ì™€ ìºì‹œ

ë¦¬ì•¡íŠ¸ í›…ì€ í•¨ìˆ˜ ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ ì§€ì—­ë³€ìˆ˜ë¥¼ ë§ˆì¹˜ ì „ì—­ë³€ìˆ˜ì²˜ëŸ¼ ì‚¬ìš©í•˜ê³  ì‹¶ë‹¤ëŠ” ë°ì„œ ì‹œì‘ëë‹¤.

ì‹¤ì œ ë°ì´í„°ëŠ” ë‹¤ë¥¸ ê³³ì— ìºì‹œí•œë‹¤. ì§€ì—­ë³€ìˆ˜ëŠ” ê·¸ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ìˆëŠ” ì¼ì¢…ì˜ `í‚¤`ë¥¼ ì €ì¥í•˜ëŠ” ê°’ìœ¼ë¡œ ì‚¬ìš©í•œë‹¤.

ğŸ“ŒÂ **ìºì‹œí•¨ìˆ˜** `createOrUse()`

```jsx
const cache: Record<String, any> = {}

export default createOrUse = <T>(key: string, callback: () => T) => {
	if (!cache[key]) 
		cache[key] = callback()
	return cache[key]
}
```

```jsx
...

export default function Cache() {
	const people = createOrUse('people', () =>
		D.makeArray(2).map(D.createRandomPerson)
	)
}

...
```

ğŸ¤“ ë¦¬ì•¡íŠ¸ì˜ í›…ì´ ì¢‹ì€ ê²ƒì€ 'people'ê³¼ ê°™ì€ í‚¤ ë¶€ë¶„ì„ ì‚¬ìš©ì ì½”ë“œì—ì„œ ê´€ë¦¬í•˜ì§€ ì•Šê³ , ë¦¬ì•¡íŠ¸ í”„ë ˆì„ì›Œí¬ ë‚´ë¶€ì—ì„œ ê´€ë¦¬í•´ì£¼ì–´ í˜¸ì¶œ ë¶€ë¶„ì„ ê°„ê²°í•˜ê²Œ í•´ì¤€ë‹¤ëŠ” ì ì´ë‹¤!

ğŸ“ŒÂ **íƒ€ì…ìŠ¤í¬ë¦½íŠ¸ Record íƒ€ì…**

```jsx
type Record<K extends keyof any, T> = {
    [P in K]: T;
};
```

íƒ€ì… `T` ì˜ í”„ë¡œí¼í‹°ì˜ ì§‘í•© `K` ë¡œ íƒ€ì…ì„ êµ¬ì„±í•œë‹¤. ì´ ìœ í‹¸ë¦¬í‹°ëŠ” íƒ€ì…ì˜ í”„ë¡œí¼í‹°ë“¤ì„ ë‹¤ë¥¸ íƒ€ì…ì— ë§¤í•‘ë˜ëŠ”ë° ì‚¬ìš©ëœë‹¤.

```jsx
interface PageInfo {
    title: string;
}

type Page = 'home' | 'about' | 'contact';

const x: Record<Page, PageInfo> = {
    about: { title: 'about' },
    contact: { title: 'contact' },
    home: { title: 'home' },
};
```

## ì˜ì¡´ì„± Dependency

(ìƒëµ)

## useMemo hook

`Memo`ëŠ” `Memoization`ì˜ ì¤„ì„ë§

```jsx
// <T>ëŠ” Genericì„ ì‚¬ìš©í•˜ê² ë‹¤ëŠ” ì˜ë¯¸
// íƒ€ì…ì´ ì•„ì§ ì •í•´ì§€ì§„ ì•Šì•˜ì§€ë§Œ ì•ìœ¼ë¡œ íƒ€ì…ì„ ì§€ì •í•˜ê² ë‹¤ëŠ” ì˜ë¯¸
function useMemo<T>(factory: () => T, deps: DependencyList | undefined): T;
```

`useMemo(**ë°ì´í„°**,[])` ê°€ ì•„ë‹ˆë¼ `useMemo(() => **ë°ì´í„°**,[])` ì˜ ë°©ì‹ì„!

```jsx
...

export default function Memo() {
	const time = useClock();
	const poeple = useMemo(() => D.makeArray(2).map(D.createRandomPerson),[])
}

...
```

ğŸ“ŒÂ **ì¬ê·€ ì•Œê³ ë¦¬ì¦˜ Recursive Algorithms**

**ì¬ê·€ í•¨ìˆ˜**

- ì–´ë–¤ í•¨ìˆ˜ì—ì„œ ìì‹ ì„ ë‹¤ì‹œ í˜¸ì¶œí•˜ì—¬ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ì‹ì˜ í•¨ìˆ˜
- ì¬ê·€ í•¨ìˆ˜ëŠ” í•¨ìˆ˜ ë‚´ì—ì„œ ë‹¤ì‹œ ìì‹ ì„ í˜¸ì¶œí–ˆì„ ë•Œ, í•´ë‹¹ í•¨ìˆ˜ê°€ ì¢…ë£Œë ë•Œê¹Œì§€ ì´í›„ì˜ ëª…ë ¹ë¬¸ì´ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ
- ì¢…ë£Œ ì¡°ê±´ì´ ê¼­ í¬í•¨ë˜ì–´ì•¼ í•¨!

```jsx
export const fibonacci = (n: number): number => {
	if (n === 0) return 0
	else if (n === 1) return 1
	return fibonacci(n-1) + fibonacci(n-2)
}
```

**useMemo**ë¥¼ ì´ìš©í•´ êµ¬í˜„í•œ `Fibo` Component

```jsx
...

export default function Fibo() {
  const memoizedFibonacci = useMemo(() => fibonacci, [])
  const fibos = useMemo(
    () => 
      D.makeArray(20+1).map((notUsed, index) => ({
        number: index,
        fibonacci: memoizedFibonacci(index)
      })),
    []
  )

	return (...)
}

...
```

## useCallback hook

`useMemo` ëŠ” ë°ì´í„°ë‚˜ í•¨ìˆ˜ í˜¸ì¶œì˜ ë¦¬í„´ê°’ì„ ìºì‹œí•˜ëŠ” ë°˜ë©´ `useCallback` ì€ ì½œë°±í•¨ìˆ˜ë¥¼ ìºì‹œí•œë‹¤.

```jsx
const Person: FC<PersonProps> = ({person}) => {
  const avatarPressed = useCallback(() => Alert.alert('avatar pressed.'), []);
  const deletePressed = useCallback(() => Alert.alert('delete pressed.'), []);
	
	// ê³ ì°¨í•¨ìˆ˜ì—ë„ ì ìš© ê°€ëŠ¥
  const countIconPressed = useCallback(
		(name: string) => () => Alert.alert(`${name} pressed`
	),[]);

	return (...)
}
```

# **04_3 useState í›… ì´í•´í•˜ê¸°**

âœ…Â useState

âœ…Â stateê°€ ê°’ì¸ ê²½ìš°

âœ…Â stateê°€ ê°ì²´ì¸ ê²½ìš°

âœ…Â ìì‹ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶€ëª¨ì»´í¬ë„ŒíŠ¸ì˜ state ë³€ê²½í•˜ê¸°

âœ…Â stateê°€ ë°°ì—´ì¸ ê²½ìš°

---

## useState hook

```jsx
function useState<S>(initialState: S | (() => S)): [S, Dispatch<SetStateAction<S>>];
```

ë°˜í™˜ëœ `Dispatch<SetStateAction<S>>` (setterí•¨ìˆ˜)ë¥¼ ì‹¤í–‰í•˜ë©´ ì»´í¬ë„ŒíŠ¸ê°€ re-rendering ë˜ê³ , ë‹¤ì‹œ ë³€ê²½ëœ ê°’ê³¼ setterí•¨ìˆ˜ë¥¼ íŠœí”Œë¡œ ë°˜í™˜í•œë‹¤.

**Dispatchì™€ SetStateAction**

```jsx
type Dispatch<A> = (value: A) => void;
type SetStateAction<S> = S | ((prevState: S) => S);
```

ì—¬ê¸°ì„œ `SetStateAction<S>` ë¥¼ ë‹¨ìˆœí™”í•˜ë©´ `Dispatch<SetStateAction<S>>` ëŠ” `(value: S) => void` íƒ€ì…ì´ ëœë‹¤.

## stateê°€ ê°’ì¸ ê²½ìš°

í´ë¦­ ì´ë²¤íŠ¸ ë°œìƒ ì‹œ ë™ì‘í•˜ëŠ” í•¨ìˆ˜ë¥¼ `useCallback` ìœ¼ë¡œ ìºì‹œí•´ë‘ê³ , ìœ„ì—ì„œ ë³¸ `SetStateAction<S>` íƒ€ì…ì˜ `((prevState: S) => S)` í˜•íƒœë¡œ setter í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ëŠ” ì½”ë“œëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

ğŸ¤“ ì´ë ‡ê²Œ í•˜ë©´ ì˜ì¡´ì„± ë°°ì—´ì— comment(ìƒíƒœê°’)ì„ ì¶”ê°€í•˜ì§€ ì•Šê³ , í•¨ìˆ˜ë¥¼ ë‹¤ì‹œ ìƒì„±í•˜ëŠ” ì¼ë„ ì—†ì´ ì‚¬ìš©í• ìˆ˜ ìˆëŠ” í•¨ìˆ˜ê°€ ëœë‹¤.

```jsx
const commentPressed = useCallback(
	() = setComment((comment) => comment + 1),
[])
```

## stateê°€ ê°ì²´ì¸ ê²½ìš°

ìƒíƒœê°’ì´ ê°ì²´ì¼ë•ŒëŠ” ë‹¤ìŒê³¼ ê°™ì´ ìƒíƒœê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.

```jsx
const commentIconPressed = useCallback(() => setPerson(person => ({
    ...person,
    counts: {
      ...person.counts,
      comment: person.counts.comment + 1
    }
  })), [])
```

**ğŸ“ŒÂ ì–•ì€ë³µì‚¬, ê¹Šì€ ë³µì‚¬**

ë¦¬ì•¡íŠ¸ í”„ë ˆì„ì›Œí¬ëŠ” í˜„ì¬ìƒíƒœì™€ setterí•¨ìˆ˜ê°€ ë°˜í™˜í•œ ìƒíƒœì— ëŒ€í•´ `currentState !== returnedState` í˜•íƒœë¡œ ìƒíƒœ ë³€ê²½ì´ ì¼ì–´ë‚¬ëŠ”ì§€ ê²€ì‚¬í•œë‹¤. 

ë§Œì•½ ì–•ì€ ë³µì‚¬ë¥¼ ì‹¤í–‰í•œ ê°ì²´ë¥¼ setterí•¨ìˆ˜ì˜ ì¸ìë¡œ ë„£ëŠ”ë‹¤ë©´ ë¦¬ì•¡íŠ¸ëŠ” ìƒíƒœê°€ ë³€ê²½ëœê²ƒì„ ê°ì§€í•  ìˆ˜ ì—†ë‹¤.

## ìì‹ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì˜ state ë³€ê²½í•˜ê¸°

ë‹¤ìŒ ì½”ë“œëŠ” ìì‹ì»´í¬ë„ŒíŠ¸ë¡œ setterí•¨ìˆ˜ë¥¼ propsë¡œ ì „ë‹¬í•  ë•Œ, setterí•¨ìˆ˜ì˜ íƒ€ì…ì„ ì„¤ì •í•˜ëŠ” ë°©ë²•ì´ë‹¤.

```jsx
import type {FC, Dispatch, SetStateAction} from 'react

export type PersonIconsProps = {
	person: D.IPerson
	setPerson: Dispatch<SetStateAction<D.IPerson>>
}

const PersonIcons: FC<PersonIconsProps> = ({person, setPerson}) => {
	...
}
```

## stateê°€ ë°°ì—´ì¸ ê²½ìš°

ë°°ì—´ ë˜í•œ ê°ì²´ì´ë¯€ë¡œ, **ê¹Šì€ ë³µì‚¬** ë¡œ ìƒíƒœê°’ì„ ë³€ê²½í•´ì•¼ í•œë‹¤.

`useMemo` ì˜ ì˜ì¡´ì„± ë°°ì—´ì— ì¶”ê°€í•˜ëŠ” ê°’ì€ ë‹¨ìˆœíˆ stateê°€ ì•„ë‹ˆë¼ `state.length` ê°€ ë˜ì–´ì•¼ í•œë‹¤.

```jsx
const children = useMemo(() =>
    personInfomations.map(({title, Component}: PersonInformation) => (
      <View style={{flex:1}} key={title}>
        <Text style={[styles.text]}>{title}</Text>
        <FlatList data={people}
          renderItem={({item}) => <Component person={item}/>}
          keyExtractor={(item, index) => item.id}
          ItemSeparatorComponent={() => <View style={styles.itemSeparator}/>}
        />
      </View>
    )), [people.length])
```